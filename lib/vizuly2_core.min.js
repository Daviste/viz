/*! Vizuly2 03-08-2018 */
(function (global, factory) {  typeof exports === 'object' && typeof module !== 'undefined' ? factory(exports) :  typeof define === 'function' && define.amd ? define(['exports'], factory) : 	(factory((global.vizuly2 = global.vizuly2 || {})));  } (this, (function (exports) { 'use strict';
var vizuly2={};vizuly2.d3=window.d3v4||window.d3,vizuly2.d3?Number(vizuly2.d3.version.substr(0,1))<4&&console.log("WARNING - Your D3 Library v"+vizuly2.d3.version+" is not compatible with this version of Vizuly.   Please use D3 v4.0.0 or higher."):console.log("WARNING - No D3 library found for vizuly2!  Please load D3 library first."),vizuly2.core={},vizuly2.viz={},vizuly2.viz.layout={},vizuly2.viz.layout.CLUSTERED="CLUSTERED",vizuly2.viz.layout.STACKED="STACKED",vizuly2.viz.layout.OVERLAP="OVERLAP",vizuly2.viz.layout.STREAM="STREAM",vizuly2.svg={},vizuly2.ui={},vizuly2.assets={},vizuly2.core.component=function(t,d,r,e){d.parent=t,d.properties=r,d.id=vizuly2.core.util.guid(),d.selection=vizuly2.d3.select(t).append("div").attr("id","div_"+d.id).style("width","100%").style("height","100%");var n=d.styles=null,a={},o=[];o.push("mouseover"),o.push("mouseout"),o.push("mousedown"),o.push("click"),o.push("dblclick"),o.push("touch"),o.push("zoom"),o.push("zoomstart"),o.push("zoomend"),o.push("initialize"),o.push("validate"),o.push("measure"),o.push("update"),o.push("styled"),Object.getOwnPropertyNames(r).forEach(function(t,e,r){o.push(t+"_change")}),e&&0<e.length&&e.forEach(function(t){o.push(t)}),d.dispatch=vizuly2.d3.dispatch.apply(this,o);var i=function(){var n,a,o;return n=i,o=(a=d).properties,Object.getOwnPropertyNames(o).forEach(function(r,t,e){void 0===a[r]&&(a[r]=o[r],n[r]=function(t){if(!arguments.length)return a[r];var e=a[r];return a[r]=t,a[r]!==e&&a.dispatch.apply(r+"_change",this,[a[r],e]),n})}),i};return d.dispatch.component=i(),i.id=function(){return d.id},i.selection=function(){return d.selection},i.style=function(t,e){return arguments.length<2?a[t]?a[t]:d.styles[t]?d.styles[t]:null:(a[t]=e,i)},i.applyStyles=function(e){return Object.keys(e).forEach(function(t){i.style(t,e[t])}),i},i.defaultStyles=function(t){if(arguments.length<1)return n;n=t,d.styles=n},i.getStyle=function(t,e){return null!=a[t]?"function"==typeof a[t]?a[t].apply(i,e):a[t]:null!=d.styles[t]?"function"==typeof d.styles[t]?d.styles[t].apply(i,e):d.styles[t]:null},i.on=function(t,e){return d.dispatch.on(t,e),i},i.onChange=function(t,e){return d.dispatch.on(t+"_change",e),i},i.validate=function(){if(!e){var e=[];if(Object.getOwnPropertyNames(r).forEach(function(t){!d[t]&&Number(0!=d[t])&&e.push(t)}),0<e.length)throw new Error("vizuly2.core.util.component.validate(): "+e.concat()+" need to be declared");d.dispatch.apply("validate",this)}},i.applyCallbacks=function(t){t.forEach(function(t){d.dispatch.on(t.on,t.callback)})},i.showDataTip=function(t,e,r,n){if(d.dataTipRenderer&&null!=d.dataTipRenderer){var a=t.getBoundingClientRect(),o=150,i=70,l=vizuly2.d3.select("body").append("div").attr("class","vz-data-tip").style("width",o+"px").style("height",i+"px").style("display","none"),u=a.left,c=a.top+window.pageYOffset,s=d.dataTipRenderer(l,t,e,r,u,c);l.style("display","block"),s&&"object"==typeof s&&s.constructor===Array&&(u=s[0],c=s[1]);var p=l.nodes()[0].getBoundingClientRect();o=p.width,i=p.height,l.style("left",u?u+"px":a.left+a.width/2-o/2+"px").style("top",c?c+"px":a.top+window.pageYOffset-i-10+"px")}},i.removeDataTip=function(){vizuly2.d3.select(".vz-data-tip").remove()},i.parent=function(){return d.parent},d.dispatch.component},vizuly2.core.util={},vizuly2.core.util.getRelativeWidth=function(t,e){if("string"==typeof t&&"%"==t.substr(t.length-1)){var r=Math.min(Number(t.substr(0,t.length-1)),100)/100;return Math.round(e.getBoundingClientRect().width*r)}return Number(t)},vizuly2.core.util.getRelativeHeight=function(t,e){if("string"==typeof t&&"%"==t.substr(t.length-1)){var r=Math.min(Number(t.substr(0,t.length-1)),100)/100;return Math.round(e.getBoundingClientRect().height*r)}return Number(t)},vizuly2.core.util.size=function(t,e,r,n){var a={};return n&&(e=vizuly2.core.util.getRelativeWidth(e,n),console.log("width = "+e),r=vizuly2.core.util.getRelativeHeight(r,n)),a.measuredWidth=e,a.measuredHeight=r,a.width=e-vizuly2.core.util.measure(t.left,e)-vizuly2.core.util.measure(t.right,e),a.height=r-vizuly2.core.util.measure(t.top,r)-vizuly2.core.util.measure(t.bottom,r),a.top=vizuly2.core.util.measure(t.top,r),a.left=vizuly2.core.util.measure(t.left,e),a.bottom=vizuly2.core.util.measure(t.bottom,r),a.right=vizuly2.core.util.measure(t.right,e),a},vizuly2.core.util.getTypedScale=function(t){return"string"==typeof t?vizuly2.d3.scaleBand():t instanceof Date?vizuly2.d3.scaleTime():vizuly2.d3.scaleLinear()},vizuly2.core.util.measure=function(t,e){if("string"==typeof t&&"%"==t.substr(t.length-1)){var r=Math.min(Number(t.substr(0,t.length-1)),100)/100;return Math.round(e*r)}return Number(t)},vizuly2.core.util.guid=function(){return"vzxxxxxxxx".replace(/[xy]/g,function(t){var e=16*Math.random()|0;return("x"===t?e:3&e|8).toString(16)})},vizuly2.core.util.getDefs=function(t){var e=t.selection().selectAll("svg defs");return e.nodes()&&e.nodes().length<1&&(e=t.selection().select("svg").append("defs")),e},vizuly2.core.util.createCSSKey=function(t){return t="css"+(t=(t=String(t).replace(",","_")).replace(/[\s+,'+,\.,\(,\),\',\&,\/]/g,"")).toUpperCase()},vizuly2.core.util.aggregateNest=function(t,u,c){for(var e=t[0];e.values;)e=e.values[0];var a=[];function s(t,e){if(e)for(var r=0;r<a.length;r++){var n=a[r];null!=t[n]&&(t["childProp_"+n]=t[n]),e["childProp_"+n]=t["childProp_"+n]?t["childProp_"+n]:t[n]}}Object.getOwnPropertyNames(e).forEach(function(t){a.push(t)}),function t(e,r){for(var n=0;n<e.length;n++){var a=e[n];if(a.values){t(a.values,a);for(var o=0;o<a.values.length;o++)for(var i=a.values[o],l=0;l<u.length;l++)isNaN(a["agg_"+u[l]])&&(a["agg_"+u[l]]=0),a["agg_"+u[l]]=c(a["agg_"+u[l]],i["agg_"+u[l]])}else for(var l=0;l<u.length;l++)a["agg_"+u[l]]=Number(a[u[l]]),isNaN(a["agg_"+u[l]])&&(a["agg_"+u[l]]=0);s(a,r)}}(t)},vizuly2.core.util.format_YEAR_Mon_MonDay=function(t){var e=vizuly2.d3.timeFormat(".%L"),r=vizuly2.d3.timeFormat(":%S"),n=vizuly2.d3.timeFormat("%I:%M"),a=vizuly2.d3.timeFormat("%I %p"),o=vizuly2.d3.timeFormat("%a %d"),i=vizuly2.d3.timeFormat("%b %d"),l=vizuly2.d3.timeFormat("%b"),u=vizuly2.d3.timeFormat("%Y");return(vizuly2.d3.timeSecond(t)<t?e:vizuly2.d3.timeMinute(t)<t?r:vizuly2.d3.timeHour(t)<t?n:vizuly2.d3.timeDay(t)<t?a:vizuly2.d3.timeMonth(t)<t?vizuly2.d3.timeWeek(t)<t?o:i:vizuly2.d3.timeYear(t)<t?l:u)(t)},vizuly2.core.util.stackOffsetBaseline=function(t,e){if(1<(r=t.length)){var r,n=1,a=t[e[0]];for(a.length;n<r;++n)a=t[e[n]]}},vizuly2.core.util.rgbToHex=function(t){var e=String(t).match(/^rgba?[\s+]?\([\s+]?(\d+)[\s+]?,[\s+]?(\d+)[\s+]?,[\s+]?(\d+)[\s+]?/i);return e&&4===e.length?"#"+("0"+parseInt(e[1],10).toString(16)).slice(-2)+("0"+parseInt(e[2],10).toString(16)).slice(-2)+("0"+parseInt(e[3],10).toString(16)).slice(-2):""},vizuly2.svg.filter={},vizuly2.svg.filter.dropShadow=function(t,e,r,n){var a=Math.round(100*e)+"_"+Math.round(100*r)+"_"+Math.round(100*n),o=t.id(),i=vizuly2.core.util.getDefs(t).selectAll("#vz_filter_"+o+"_"+a).data([a]).enter().append("filter").attr("id","vz_filter_"+o+"_"+a).attr("class","vz-svg-filter-dropShadow").attr("width","300%").attr("height","300%");i.append("feGaussianBlur").attr("in","SourceAlpha").attr("stdDeviation",n),i.append("feOffset").attr("dx",e).attr("dy",r),i.append("feComponentTransfer").append("feFuncA").attr("type","linear").attr("slope",.2);var l=i.append("feMerge");return l.append("feMergeNode"),l.append("feMergeNode").attr("in","SourceGraphic"),"#vz_filter_"+o+"_"+a},vizuly2.svg.gradient={},vizuly2.svg.gradient.blend=function(t,e,r,n){var a,o,i,l,u=String(e).replace("#","")+String(r).replace("#",""),c="vz_gradient_blend_"+t.id()+"_"+u;"horizontal"==n?(a="100%",l=i=o="0%"):(i="100%",l=o=a="0%");var s=vizuly2.core.util.getDefs(t),p=s.selectAll("#"+c).data([u]);return(p=p.enter().append("linearGradient").attr("id",c).attr("class","vz-svg-gradient-blend").attr("x1",a).attr("x2",o).attr("y1",i).attr("y2",l)).append("stop").attr("offset","0%").attr("stop-color",e),p.append("stop").attr("offset","100%").attr("stop-color",r),p=s.selectAll("#"+c)},vizuly2.svg.gradient.radialBlend=function(t,e,r,n,a,o,i,l,u){var c=String(n).replace("#","")+String(a).replace("#","")+String(o).replace("%","")+String(i).replace("%",""),s="vz_gradient_radial_blend_"+t.id()+"_"+c,p=vizuly2.core.util.getDefs(t),d=p.selectAll("#"+s).data([c]);return(d=d.enter().append("radialGradient").attr("id",s).attr("class","vz-svg-gradient-radial-blend").attr("cx",e).attr("cy",r)).append("stop").attr("offset",o).attr("stop-color",n).attr("stop-opacity",void 0===l?1:l),d.append("stop").attr("offset",i).attr("stop-color",a).attr("stop-opacity",void 0===u?1:u),d=p.selectAll("#"+s)},vizuly2.svg.gradient.fade=function(t,e,r,n,a){a||(a=[0,1]),n||(n=[.75,.9]);var o,i,l,u,c=String(e).replace("#",""),s="vz_gradient_fade_"+t.id()+"_"+c;"horizontal"==r?(i="100%",u=l=o="0%"):(l="100%",u=i=o="0%");var p=vizuly2.core.util.getDefs(t),d=p.selectAll("#"+s).data([c]).enter().append("linearGradient").attr("id",s).attr("class","vz-svg-gradient-fade").attr("x1",o).attr("x2",i).attr("y1",l).attr("y2",u);return d.append("stop").attr("offset",100*a[0]+"%").attr("stop-color",e).attr("stop-opacity",n[0]),d.append("stop").attr("offset",100*a[1]+"%").attr("stop-color",e).attr("stop-opacity",n[1]),d=p.selectAll("#"+s)},vizuly2.svg.gradient.radialFade=function(t,e,r,n){n||(n=[0,1]),r||(r=[.75,.9]);var a=String(e).replace("#",""),o="vz_gradient_radial_fade"+t.id()+"_"+a,i=vizuly2.core.util.getDefs(t),l=i.selectAll("#"+o).data([a]).enter().append("radialGradient").attr("id",o).attr("class","vz-svg-gradient-radial-fade");return l.append("stop").attr("offset",100*n[0]+"%").attr("stop-color",e).attr("stop-opacity",r[0]),l.append("stop").attr("offset",100*n[1]+"%").attr("stop-color",e).attr("stop-opacity",r[1]),l=i.selectAll("#"+o)},vizuly2.svg.gradient.darker=function(t,e,r){var n,a,o,i,l=String(e).replace("#",""),u="vz_gradient_darker_"+t.id()+"_"+l;"horizontal"==r?(n="100%",i=o=a="0%"):(o="100%",i=a=n="0%");var c=vizuly2.core.util.getDefs(t),s=c.selectAll("#"+u).data([l]).enter().append("linearGradient").attr("class","vz-gradient-darker").attr("id",u).attr("x1",n).attr("x2",a).attr("y1",o).attr("y2",i);return s.append("stop").attr("offset","0%").attr("stop-color",e).attr("stop-opacity",.75),s.append("stop").attr("offset","100%").attr("stop-color",vizuly2.d3.rgb(e).darker()).attr("stop-opacity",.9),s=c.selectAll("#"+u)},vizuly2.svg.text={},vizuly2.svg.text.textArcPath=function(t,e){var r={};r.angle=e,r.startAngle=r.angle-179*.0174533,r.endAngle=r.angle+179*.0174533;var n=d3.arc().innerRadius(t).outerRadius(t)(r),a=/[Mm][\d\.\-e,\s]+[Aa][\d\.\-e,\s]+/.exec(n);return a&&(a=a[0]),a},vizuly2.svg.text.wrap=function(t,c,s,p){var d=t.attr("x"),e=t.attr("y");d=!d||isNaN(d)?0:d,e=!e||isNaN(e)?0:e;var f=p/3;t.each(function(){var t,e=d3.select(this),r=c.split(/\s+/).reverse(),n=[],a=0,o=p,i=e.attr("y"),l=1.1*parseFloat(p/2)+f;isNaN(l)&&(l=0);for(var u=e.text(null).append("tspan").attr("x",d).attr("y",i).attr("y",l).style("font-size",p+"px");t=r.pop();)n.push(t),u.text(n.join(" ")),u.node().getComputedTextLength()>s&&(n.pop(),u.text(n.join(" ")),n=[t],u=e.append("tspan").attr("x",d).attr("y",++a*o+l+i).text(t).style("font-size",p+"px"))})};var a={};function o(e,r,n){return function(){var t=n.apply(r,arguments);return t===r?e:t}}function d(t,e){for(var r=[t],n=[];null!=(t=r.pop());)if(n.push(t),(o=t.children)&&(a=o.length))for(var a,o,i=-1;++i<a;)r.push(o[i]);for(;null!=(t=n.pop());)e(t)}function t(t){return t.children}function e(t){return t.value}function r(t,e){return e.value-t.value}function n(t){return a.merge(t.map(function(e){return(e.children||[]).map(function(t){return{source:e,target:t}})}))}function i(t,e){return t.value-e.value}function x(t,e){var r=t._pack_next;(t._pack_next=e)._pack_prev=t,(e._pack_next=r)._pack_prev=e}function b(t,e){(t._pack_next=e)._pack_prev=t}function z(t,e){var r=e.x-t.x,n=e.y-t.y,a=t.r+e.r;return r*r+n*n<.999*a*a}function f(t){if((e=t.children)&&(u=e.length)){var e,r,n,a,o,i,l,u,c=1/0,s=-1/0,p=1/0,d=-1/0;if(e.forEach(M),(r=e[0]).x=-r.r,r.y=0,m(r),1<u&&((n=e[1]).x=n.r,n.y=0,m(n),2<u))for(S(r,n,a=e[2]),m(a),x(r,a),x(r._pack_prev=a,n),n=r._pack_next,o=3;o<u;o++){S(r,n,a=e[o]);var f=0,h=1,g=1;for(i=n._pack_next;i!==n;i=i._pack_next,h++)if(z(i,a)){f=1;break}if(1==f)for(l=r._pack_prev;l!==i._pack_prev&&!z(l,a);l=l._pack_prev,g++);f?(h<g||h==g&&n.r<r.r?b(r,n=i):b(r=l,n),o--):(x(r,a),m(n=a))}var v=(c+s)/2,y=(p+d)/2,_=0;for(o=0;o<u;o++)(a=e[o]).x-=v,a.y-=y,_=Math.max(_,a.r+Math.sqrt(a.x*a.x+a.y*a.y));t.r=_,e.forEach(k)}function m(t){c=Math.min(t.x-t.r,c),s=Math.max(t.x+t.r,s),p=Math.min(t.y-t.r,p),d=Math.max(t.y+t.r,d)}}function M(t){t._pack_next=t._pack_prev=t}function k(t){delete t._pack_next,delete t._pack_prev}function S(t,e,r){var n=t.r+r.r,a=e.x-t.x,o=e.y-t.y;if(n&&(a||o)){var i=e.r+r.r,l=a*a+o*o,u=.5+((n*=n)-(i*=i))/(2*l),c=Math.sqrt(Math.max(0,2*i*(n+l)-(n-=l)*n-i*i))/(2*l);r.x=t.x+u*a+c*o,r.y=t.y+u*o-c*a}else r.x=t.x+n,r.y=t.y}a.layout={},a.svg={},a.functor=function(t){return"function"==typeof t?t:function(){return t}},a.merge=function(t){for(var e,r,n,a=t.length,o=-1,i=0;++o<a;)i+=t[o].length;for(r=new Array(i);0<=--a;)for(e=(n=t[a]).length;0<=--e;)r[--i]=n[e];return r},a.rebind=function(t,e){for(var r,n=1,a=arguments.length;++n<a;)t[r=arguments[n]]=o(t,e,e[r]);return t},a.layout.hierarchy=function(){var l=r,u=t,c=e;function s(t){var e,r=[t],n=[];for(t.depth=0;null!=(e=r.pop());)if(n.push(e),(o=u.call(s,e,e.depth))&&(a=o.length)){for(var a,o,i;0<=--a;)r.push(i=o[a]),i.parent=e,i.depth=e.depth+1;c&&(e.value=0),e.children=o}else c&&(e.value=+c.call(s,e,e.depth)||0),delete e.children;return d(t,function(t){var e,r;l&&(e=t.children)&&e.sort(l),c&&(r=t.parent)&&(r.value+=t.value)}),n}return s.sort=function(t){return arguments.length?(l=t,s):l},s.children=function(t){return arguments.length?(u=t,s):u},s.value=function(t){return arguments.length?(c=t,s):c},s.revalue=function(t){return c&&(!function(t,e){var r=[t];for(;null!=(t=r.pop());)if(e(t),(a=t.children)&&(n=a.length))for(var n,a;0<=--n;)r.push(a[n])}(t,function(t){t.children&&(t.value=0)}),d(t,function(t){var e;t.children||(t.value=+c.call(s,t,t.depth)||0),(e=t.parent)&&(e.value+=t.value)})),t},s},a.layout.pack=function(){var u,t,e,c=a.layout.hierarchy().sort(i),s=0,p=[1,1];function r(t,e){var r=c.call(this,t,e),n=r[0],a=p[0],o=p[1],i=null==u?Math.sqrt:"function"==typeof u?u:function(){return u};if(n.x=n.y=0,d(n,function(t){t.r=+i(t.value)}),d(n,f),s){var l=s*(u?1:Math.max(2*n.r/a,2*n.r/o))/2;d(n,function(t){t.r+=l}),d(n,f),d(n,function(t){t.r-=l})}return function t(e,r,n,a){var o=e.children;e.x=r+=a*e.x;e.y=n+=a*e.y;e.r*=a;if(o)for(var i=-1,l=o.length;++i<l;)t(o[i],r,n,a)}(n,a/2,o/2,u?1:1/Math.max(2*n.r/a,2*n.r/o)),r}return r.size=function(t){return arguments.length?(p=t,r):p},r.radius=function(t){return arguments.length?(u=null==t||"function"==typeof t?t:+t,r):u},r.padding=function(t){return arguments.length?(s=+t,r):s},t=r,e=c,a.rebind(t,e,"sort","children","value"),(t.nodes=t).links=n,t},a.svg.diagonal=function(){var i=function(t){return t.source},l=function(t){return t.target},u=function(t){return[t.x,t.y]};function e(t,e){var r=i.call(this,t,e),n=l.call(this,t,e),a=(r.y+n.y)/2,o=[r,{x:r.x,y:a},{x:n.x,y:a},n];return"M"+(o=o.map(u))[0]+"C"+o[1]+" "+o[2]+" "+o[3]}return e.source=function(t){return arguments.length?(i=a.functor(t),e):i},e.target=function(t){return arguments.length?(l=a.functor(t),e):l},e.projection=function(t){return arguments.length?(u=t,e):u},e},a.svg.diagonal.radial=function(){var t=a.svg.diagonal(),n=function(t){return[t.x,t.y]},e=t.projection;return t.projection=function(t){return arguments.length?e(function(t){return n=t,function(){var t=n.apply(this,arguments),e=t[0],r=t[1]-halfπ;return[e*Math.cos(r),e*Math.sin(r)]}}):n},t},vizuly2.d3v3=a;
 Object.keys(vizuly2).forEach(function (key) { exports[key] = vizuly2[key]});
 Object.defineProperty(exports, '__esModule', { value: true });})));